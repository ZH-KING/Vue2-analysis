{"version":3,"file":"vue.js","sources":["../src/compiler/index.js","../src/utils/index.js","../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-08 14:54:51\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-09 11:25:43\r\n * @FilePath: \\vue2-rollup\\src\\compiler\\index.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\n// 以下为vue源码的正则\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; //匹配标签名；形如 abc-123\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //匹配特殊标签;形如 abc:234,前面的abc:可有可无；获取标签名；\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 匹配标签开头；形如  <  ；捕获里面的标签名\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结尾，形如 >、/>\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配结束标签 如 </abc-123> 捕获里面的标签名\r\nconst attribute =\r\n  /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性  形如 id=\"app\"\r\nexport function compileToFunction(template){\r\n\r\n    //1、将template转成AST语法树：AST用来描述代码本身形成树结构，不仅可以描述html，也能描述css以及js语法\r\n    let asp = parseHTML(template);\r\n    //2、生成render方法\r\n    \r\n}\r\nfunction parseHTML(template){\r\n\r\n    const ELEMENT_TYPE = 1;\r\n    const TEXT_TYPE = 3;\r\n    const stack = []; // 用于存放元素\r\n    let currentParent; // 指向的是栈中的最后一个\r\n    let root;\r\n\r\n    // 最终需要转化成一颗抽象语法树\r\n    function createASTElement(tag, attrs){\r\n        return {\r\n            tag,\r\n            type: ELEMENT_TYPE,\r\n            children: [],\r\n            attrs,\r\n            parent: null\r\n        }\r\n    }\r\n    \r\n    function start(tagName, attrs){\r\n        let node = createASTElement(tagName, attrs)\r\n        // 如果没有根元素，那么当前元素为根元素\r\n        if(!root){\r\n            root = node;\r\n        }\r\n        // 给当前节点绑定父子关系\r\n        if(currentParent){\r\n            node.parent = currentParent;\r\n            currentParent.children.push(node)\r\n        }\r\n        // 将当前元素放入栈中\r\n        stack.push(node);\r\n        // 当前currentParent为当前节点\r\n        currentParent = node\r\n    }\r\n\r\n    function chars(text){\r\n        text = text.replace(/\\s/g, '')\r\n        // 文本直接放到当前指向的节点中\r\n        if(text){\r\n            currentParent.children.push({\r\n                type: TEXT_TYPE,\r\n                text,\r\n                parent: currentParent\r\n            })\r\n        }\r\n    }\r\n    function end(tagName){\r\n        // 处理到结束标签时，将该元素从栈中移出\r\n        let node = stack.pop()\r\n        // 此时currentParent为stack中的上一个元素\r\n        currentParent = stack[stack.length - 1]\r\n    }\r\n    // 截取 template 字符串，每次匹配到了就截掉\r\n    function advance(n){\r\n        template = template.substring(n)\r\n    }\r\n    // 解析开始标签\r\n    function parseStartTag(){\r\n        // 匹配开始标签\r\n        const start = template.match(startTagOpen)\r\n        // start 格式为：['<div', 'div', index: 0, groups: undefined, input: '<div id=\\\"app\\\">']\r\n        if(start){\r\n            const match = {\r\n                tagName: start[1], // 标签名\r\n                attrs: []\r\n            }\r\n            advance(start[0].length)\r\n\r\n            // 如果不是开始标签的结束，就一直匹配下去\r\n            // attr 格式为：[\"class=\\\"myClass\\\"\", \"class\", \"=\", \"myClass\", undefined, undefined]\r\n            let attr,end;\r\n            while(!(end = template.match(startTagClose)) && (attr = template.match(attribute))){\r\n                advance(attr[0].length)\r\n                match.attrs.push({\r\n                    name: attr[1],\r\n                    value: attr[3] || attr[4] || attr[5]\r\n                })\r\n            }\r\n            if(end){\r\n                advance(end[0].length)   \r\n            }\r\n            return match\r\n        }\r\n        \r\n        return false;\r\n    }\r\n    /**\r\n     * 递归解析template，进行初步处理\r\n     * 解析开始标签，将结果 {tagName, attrs} 交给handleStartTag函数处理\r\n     * 解析结束标签，将结果 tagName 交给 handleEndTag 函数处理\r\n     * 解析文本类型，将结果 text 交给 handleChars 函数处理\r\n     */\r\n    while(template){\r\n        // 查找 < 的位置，根据它的位置判断第一个元素是什么标签\r\n        let textEnd = template.indexOf(\"<\")\r\n        // 第一个元素为 '<' 时，即碰到开始/结束标签\r\n        if(textEnd === 0){\r\n            // 匹配到开始标签 例如：<div>\r\n            const startTagMatch = parseStartTag()\r\n            if(startTagMatch){\r\n                start(startTagMatch.tagName, startTagMatch.attrs)\r\n                continue\r\n            }\r\n            // 匹配到结束标签 例如：</div>\r\n            const endTagMatch = template.match(endTag)\r\n            if(endTagMatch){\r\n                end(endTagMatch[1])\r\n                advance(endTagMatch[0].length)\r\n                continue\r\n            }\r\n        }\r\n        // 第一个元素为文本时\r\n        if(textEnd > 0){\r\n            let text = template.substring(0,textEnd)\r\n            if(text){\r\n                chars(text)\r\n                advance(text.length)\r\n            }\r\n        }\r\n    }\r\n    console.log(root)\r\n    return root;\r\n}","/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-07 16:56:24\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-07 17:14:13\r\n * @FilePath: \\vue2-rollup\\src\\utils\\index.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\nexport function isFunction(val){\r\n    return typeof val === 'function';\r\n}\r\nexport function isObject(val){\r\n    return typeof val === 'object';\r\n}","/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-08 13:40:22\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-08 14:19:28\r\n * @FilePath: \\vue2-rollup\\src\\observe\\array.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\n// 获取数组原型\r\nlet oldArrayProto = Array.prototype;\r\n// newArrayProto.__proto__ = oldArrayProto\r\nexport let newArrayProto = Object.create(oldArrayProto)\r\n\r\nlet methods = [\r\n    \"push\",\r\n    \"pop\",\r\n    \"shift\",\r\n    \"unshift\",\r\n    \"sort\",\r\n    \"reverse\",\r\n    \"splice\"\r\n]\r\n\r\nmethods.forEach(method=>{\r\n    // 重写数组方法\r\n    newArrayProto[method] = function(...args){\r\n        // 调用原数组方法，切片编程\r\n        const result = oldArrayProto[method].call(this, ...args)\r\n\r\n        // 对新增的数据进行劫持\r\n        let inserted;\r\n        let ob = this.__ob__;\r\n        switch(method){\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = args;\r\n                break;\r\n            case 'splice':\r\n                inserted = args.slice(2);\r\n                break;\r\n            default: \r\n                break;\r\n        }\r\n        // 对新增的数据进行观测\r\n        if(inserted){\r\n            ob.observeArray(inserted)\r\n        }\r\n        console.log(\"method\", ob)\r\n        return result\r\n    }\r\n})","/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-07 17:11:23\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-08 14:20:17\r\n * @FilePath: \\vue2-rollup\\src\\observe\\index.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\n\r\nimport { isObject } from \"../utils/index\";\r\nimport { newArrayProto } from \"./array\";\r\n\r\nclass Observer{\r\n    constructor(data){\r\n        // 将__ob__变成不可枚举（循环的时候无法获取）\r\n        Object.defineProperty(data, '__ob__', {\r\n            value: this,\r\n            enumerable: false\r\n        })\r\n        // data.__ob__ = this;\r\n        if(Array.isArray(data)){\r\n            // 保留数组原有的特性，并且重写部分方法\r\n            data.__proto__ =  newArrayProto\r\n            this.observeArray(data)\r\n        }else{\r\n            this.walk(data)\r\n        }\r\n    }\r\n    walk(data){\r\n        Object.keys(data).forEach(key=>{\r\n            // 对 data 中的每个属性进行响应式处理\r\n            defineReactive(data, key, data[key])\r\n        })\r\n    }\r\n    observeArray(data){\r\n        data.forEach(item => observe(item))\r\n    }\r\n}\r\n\r\nfunction defineReactive(data, key, value){\r\n    // 对深层次对象进行递归处理\r\n    observe(value)\r\n    // 重写对象，给每个属性添加get和set\r\n    Object.defineProperty(data, key, {\r\n        get(){\r\n            return value\r\n        },\r\n        set(newVal){\r\n            if(newVal === value) return;\r\n            // 对象赋值  重新代理\r\n            observe(newVal)\r\n            value = newVal\r\n        }\r\n    })\r\n}\r\n\r\nexport function observe(data){\r\n    // 判断data是否返回一个对象，vue要求data return {}\r\n    if(!isObject(data)) return\r\n    // 说明这个对象已经被代理过了\r\n    if(data.__ob__ instanceof Observer){\r\n        return data.__ob__;\r\n    }\r\n    // 返回一个响应式对象\r\n    return new Observer(data)\r\n}","/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-07 16:46:24\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-07 17:27:13\r\n * @FilePath: \\vue2-rollup\\src\\state.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\nimport { observe } from './observe/index';\r\nimport { isFunction } from './utils/index'\r\nexport function initState(vm){\r\n    const opts = vm.$options;\r\n    // 初始化data\r\n    if(opts.data){\r\n        initData(vm)\r\n    }\r\n}\r\n// 初始化data\r\nfunction initData(vm){\r\n    let data = vm.$options.data;\r\n    // 往实例上添加一个 _data 属性，即传入的data\r\n    // vue组件data推荐使用函数，防止数据在组件之间共享\r\n    data = vm._data = isFunction(data) ? data.call(vm) : data;\r\n    // 将vm._data上的数据代理到vm上\r\n    for(let key in data){\r\n        proxy(vm, \"_data\", key)\r\n    }\r\n    // 对数据进行观测\r\n    observe(data)\r\n}\r\n// 代理数据\r\nfunction proxy(vm, source, key){\r\n    Object.defineProperty(vm, key, {\r\n        get(){\r\n            return vm[source][key]\r\n        },\r\n        set(newVal){\r\n            vm[source][key] = newVal\r\n        }\r\n    })\r\n}\r\n","import { compileToFunction } from \"./compiler\";\r\nimport { initState } from \"./state\";\r\n\r\n/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-07 16:39:18\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-08 15:04:16\r\n * @FilePath: \\vue2-rollup\\src\\init.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\nexport function initMixin(Vue){\r\n    Vue.prototype._init = function(options){\r\n        const vm = this;\r\n        // 在实例上添加 $options 属性\r\n        vm.$options = options;\r\n        // 初始化状态，包括initProps、initData、initMethod、initComputed、initWatch等\r\n        initState(vm)\r\n        // 挂载数据\r\n        if(options.el){\r\n            vm.$mount(options.el)\r\n        }\r\n    }\r\n    Vue.prototype.$mount = function(el){\r\n        const vm = this;\r\n        const opts = vm.$options;\r\n        el = document.querySelector(el)\r\n        /**\r\n         * 1、把模板转化成render函数\r\n         * 2、执行render函数，生成VNode\r\n         * 3、更新时进行diff\r\n         * 4、产生真实DOM\r\n         */\r\n        // 可以直接在options中写render函数\r\n        // 优先级： render > template > el\r\n        if(!opts.render){\r\n            let template = opts.template\r\n            if(!opts.template && el){\r\n                template = el.outerHTML;\r\n            }\r\n            // 写了 template 就用写了的 template\r\n            if(template){\r\n                // 将 template转化成render函数\r\n                const render = compileToFunction(template)\r\n                opts.render = render;\r\n            }\r\n        }\r\n        \r\n\r\n    }\r\n}\r\n\r\n","/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-07 16:11:59\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-07 16:42:34\r\n * @FilePath: \\vue2-rollup\\src\\index.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\n\r\nimport { initMixin } from \"./init\"\r\n\r\n// 创建一个Vue构造函数\r\nfunction Vue(options){\r\n    this._init(options)\r\n}\r\ninitMixin(Vue)\r\nexport default Vue"],"names":["ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","attribute","compileToFunction","template","parseHTML","ELEMENT_TYPE","TEXT_TYPE","stack","currentParent","root","createASTElement","tag","attrs","type","children","parent","start","tagName","node","push","chars","text","replace","end","pop","length","advance","n","substring","parseStartTag","match","attr","name","value","textEnd","indexOf","startTagMatch","endTagMatch","console","log","isFunction","val","isObject","oldArrayProto","Array","prototype","newArrayProto","Object","create","methods","forEach","method","args","result","call","inserted","ob","__ob__","slice","observeArray","Observer","data","defineProperty","enumerable","isArray","__proto__","walk","keys","key","defineReactive","item","observe","get","set","newVal","initState","vm","opts","$options","initData","_data","proxy","source","initMixin","Vue","_init","options","el","$mount","document","querySelector","render","outerHTML"],"mappings":"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"}