{"version":3,"file":"vue.js","sources":["../src/utils/index.js","../src/globalApi/index.js","../src/compiler/generate.js","../src/compiler/parse.js","../src/compiler/index.js","../src/observe/array.js","../src/observe/dep.js","../src/observe/index.js","../src/state.js","../src/observe/watcher.js","../src/vdom/index.js","../src/lifecycle.js","../src/init.js","../src/index.js"],"sourcesContent":["/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-07 16:56:24\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-14 15:25:15\r\n * @FilePath: \\vue2-rollup\\src\\utils\\index.js\r\n * @Description:\r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved.\r\n */\r\nexport function isFunction(val) {\r\n  return typeof val === \"function\";\r\n}\r\nexport function isObject(val) {\r\n  return typeof val === \"object\";\r\n}\r\n\r\nconst strats = {};\r\nconst LIFECYCLE = [\"beforeCreate\", \"created\"];\r\nLIFECYCLE.forEach((hook) => {\r\n  strats[hook] = function (p, c) {\r\n    if (c) {\r\n      if (p) {\r\n        return p.concat(c);\r\n      } else {\r\n        return [c];\r\n      }\r\n    } else {\r\n      return p;\r\n    }\r\n  };\r\n});\r\nexport function mergeOptions(parent, child) {\r\n  const options = {};\r\n  for (let key in parent) {\r\n    mergeField(key);\r\n  }\r\n  for (let key in child) {\r\n    if (!parent.hasOwnProperty(key)) {\r\n      mergeField(key);\r\n    }\r\n  }\r\n  function mergeField(key) {\r\n    if (strats[key]) {\r\n      options[key] = strats[key](parent[key], child[key]);\r\n    } else {\r\n      options[key] = child[key] || parent[key];\r\n    }\r\n  }\r\n  return options;\r\n}\r\n","import { mergeOptions } from \"../utils\";\r\n\r\n/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-14 14:26:59\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-14 15:25:09\r\n * @FilePath: \\vue2-rollup\\src\\globalApi\\index.js\r\n * @Description:\r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved.\r\n */\r\nexport function initGlobalApi(Vue) {\r\n\r\n  Vue.options = {};\r\n  \r\n  Vue.mixin = function (mixin) {\r\n    // 我们期望将用户的选项和全局的options进行合并\r\n    this.options = mergeOptions(this.options, mixin);\r\n    return this;\r\n  };\r\n}\r\n","/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-09 13:58:03\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-09 16:44:25\r\n * @FilePath: \\vue2-rollup\\src\\compiler\\generate.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // 匹配花括号 {{  }}；捕获花括号里面的内容\r\n\r\nfunction genProps(attrs){\r\n    let str = ''\r\n    for(let i=0;i<attrs.length;i++){\r\n        let attr = attrs[i]\r\n        // 如果属性为 style 时，转化为 style:{a:b,c:d} 格式\r\n        if(attr.name === 'style'){\r\n            let obj = {}\r\n            attr.value.split(\";\").forEach(item => {\r\n                let [key, value] = item.split(\":\");\r\n                obj[key] = value\r\n            });\r\n            attr.value = obj\r\n        }\r\n        // 结果变为 a:b,c:d,...\r\n        str += `${attr.name}:${JSON.stringify(attr.value)},`\r\n        \r\n    }\r\n    // 删掉多余的逗号\r\n    return `{${str.slice(0,-1)}}`\r\n}\r\n\r\nfunction gen(node){\r\n    if(node.type === 1){\r\n        return codegen(node)\r\n    }else{\r\n        // 如果是纯文本\r\n        let text = node.text;\r\n        if(!defaultTagRE.test(text)){\r\n            return `_v(${JSON.stringify(text)})`\r\n        }else{\r\n            let tokens = [];\r\n            let match,index;\r\n            // 正则是全局模式 每次需要重置正则的lastIndex属性，不然会引发匹配bug（defaultTagRE.exec()匹配完一次后，再次匹配为null，需要重置lastIndex）\r\n            defaultTagRE.lastIndex = 0;\r\n            let lastIndex = 0;\r\n            while(match = defaultTagRE.exec(text)){\r\n                // 匹配的位置\r\n                index = match.index;\r\n                // 放入文本值  {{name}}  hello {{age}}  取hello放入tokens\r\n                if(index > lastIndex){\r\n                    tokens.push(JSON.stringify(text.slice(lastIndex, index)))\r\n                }\r\n                // tokens中放入变量\r\n                tokens.push(`_s(${match[1].trim()})`)\r\n                // 记录 }} 结束的位置\r\n                lastIndex = index + match[0].length\r\n            }\r\n            // 如果匹配完了花括号，text里面还有剩余的普通文本，那么继续push到tokens\r\n            if(lastIndex < text.length){\r\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n            }\r\n            return `_v(${tokens.join(\"+\")})`\r\n        }\r\n    }\r\n}\r\n\r\nfunction genChildren(children){\r\n    if(children){\r\n        return children.map(child=>gen(child)).join(\",\")\r\n    }\r\n}\r\n\r\nexport function codegen(ast){\r\n    let children = genChildren(ast.children)\r\n    let code = `_c('${ast.tag}',${ast.attrs.length > 0 ? genProps(ast.attrs) : null\r\n    }${ast.children.length > 0 ? `,${children}` : ''\r\n    })`\r\n    return code\r\n}","// 以下为vue源码的正则\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; //匹配标签名；形如 abc-123\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //匹配特殊标签;形如 abc:234,前面的abc:可有可无；获取标签名；\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 匹配标签开头；形如  <  ；捕获里面的标签名\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结尾，形如 >、/>\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配结束标签 如 </abc-123> 捕获里面的标签名\r\nconst attribute =\r\n  /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性  形如 id=\"app\"\r\n\r\nexport function parseHTML(template){\r\n\r\n    const ELEMENT_TYPE = 1;\r\n    const TEXT_TYPE = 3;\r\n    const stack = []; // 用于存放元素\r\n    let currentParent; // 指向的是栈中的最后一个\r\n    let root;\r\n\r\n    // 最终需要转化成一颗抽象语法树\r\n    function createASTElement(tag, attrs){\r\n        return {\r\n            tag,\r\n            type: ELEMENT_TYPE,\r\n            children: [],\r\n            attrs,\r\n            parent: null\r\n        }\r\n    }\r\n    \r\n    function start(tagName, attrs){\r\n        let node = createASTElement(tagName, attrs)\r\n        // 如果没有根元素，那么当前元素为根元素\r\n        if(!root){\r\n            root = node;\r\n        }\r\n        // 给当前节点绑定父子关系\r\n        if(currentParent){\r\n            node.parent = currentParent;\r\n            currentParent.children.push(node)\r\n        }\r\n        // 将当前元素放入栈中\r\n        stack.push(node);\r\n        // 当前currentParent为当前节点\r\n        currentParent = node\r\n    }\r\n\r\n    function chars(text){\r\n        text = text.replace(/\\s/g, '')\r\n        // 文本直接放到当前指向的节点中\r\n        if(text){\r\n            currentParent.children.push({\r\n                type: TEXT_TYPE,\r\n                text,\r\n                parent: currentParent\r\n            })\r\n        }\r\n    }\r\n    function end(tagName){\r\n        // 处理到结束标签时，将该元素从栈中移出\r\n        let node = stack.pop()\r\n        // 此时currentParent为stack中的上一个元素\r\n        currentParent = stack[stack.length - 1]\r\n    }\r\n    // 截取 template 字符串，每次匹配到了就截掉\r\n    function advance(n){\r\n        template = template.substring(n)\r\n    }\r\n    // 解析开始标签\r\n    function parseStartTag(){\r\n        // 匹配开始标签\r\n        const start = template.match(startTagOpen)\r\n        // start 格式为：['<div', 'div', index: 0, groups: undefined, input: '<div id=\\\"app\\\">']\r\n        if(start){\r\n            const match = {\r\n                tagName: start[1], // 标签名\r\n                attrs: []\r\n            }\r\n            advance(start[0].length)\r\n\r\n            // 如果不是开始标签的结束，就一直匹配下去\r\n            // attr 格式为：[\"class=\\\"myClass\\\"\", \"class\", \"=\", \"myClass\", undefined, undefined]\r\n            let attr,end;\r\n            while(!(end = template.match(startTagClose)) && (attr = template.match(attribute))){\r\n                advance(attr[0].length)\r\n                match.attrs.push({\r\n                    name: attr[1],\r\n                    value: attr[3] || attr[4] || attr[5]\r\n                })\r\n            }\r\n            if(end){\r\n                advance(end[0].length)   \r\n            }\r\n            return match\r\n        }\r\n        \r\n        return false;\r\n    }\r\n    /**\r\n     * 递归解析template，进行初步处理\r\n     * 解析开始标签，将结果 {tagName, attrs} 交给handleStartTag函数处理\r\n     * 解析结束标签，将结果 tagName 交给 handleEndTag 函数处理\r\n     * 解析文本类型，将结果 text 交给 handleChars 函数处理\r\n     */\r\n    while(template){\r\n        // 查找 < 的位置，根据它的位置判断第一个元素是什么标签\r\n        let textEnd = template.indexOf(\"<\")\r\n        // 第一个元素为 '<' 时，即碰到开始/结束标签\r\n        if(textEnd === 0){\r\n            // 匹配到开始标签 例如：<div>\r\n            const startTagMatch = parseStartTag()\r\n            if(startTagMatch){\r\n                start(startTagMatch.tagName, startTagMatch.attrs)\r\n                continue\r\n            }\r\n            // 匹配到结束标签 例如：</div>\r\n            const endTagMatch = template.match(endTag)\r\n            if(endTagMatch){\r\n                end(endTagMatch[1])\r\n                advance(endTagMatch[0].length)\r\n                continue\r\n            }\r\n        }\r\n        // 第一个元素为文本时\r\n        if(textEnd > 0){\r\n            let text = template.substring(0,textEnd)\r\n            if(text){\r\n                chars(text)\r\n                advance(text.length)\r\n            }\r\n        }\r\n    }\r\n    return root;\r\n}","/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-08 14:54:51\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-09 17:38:52\r\n * @FilePath: \\vue2-rollup\\src\\compiler\\index.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\nimport { codegen } from \"./generate\";\r\nimport { parseHTML } from \"./parse\";\r\n\r\nexport function compileToFunction(template){\r\n\r\n    // 1、将template转成AST语法树：AST用来描述代码本身形成树结构，不仅可以描述html，也能描述css以及js语法\r\n    let ast = parseHTML(template);\r\n    /**\r\n     * 2、通过AST，重新生成代码\r\n     * 生成的代码需要跟render函数一样\r\n     * 类似 _c('div',{id: \"app\"},_c('div',undefined,_v(_s(name)),_c('span',undefined,_v(_s(age))))\r\n     * _c代表创建元素 _v代表创建文本 _s代表变量\r\n     */\r\n\r\n    let code = codegen(ast)\r\n    // 模板引擎的实现原理就是 with + new Function\r\n    code = `with(this){return ${code}}`\r\n    let render = new Function(code)\r\n    \r\n    return render\r\n}\r\n","/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-08 13:40:22\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-14 17:32:48\r\n * @FilePath: \\vue2-rollup\\src\\observe\\array.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\n// 获取数组原型\r\nlet oldArrayProto = Array.prototype;\r\n// newArrayProto.__proto__ = oldArrayProto\r\nexport let newArrayProto = Object.create(oldArrayProto)\r\n\r\nlet methods = [\r\n    \"push\",\r\n    \"pop\",\r\n    \"shift\",\r\n    \"unshift\",\r\n    \"sort\",\r\n    \"reverse\",\r\n    \"splice\"\r\n]\r\n\r\nmethods.forEach(method=>{\r\n    // 重写数组方法\r\n    newArrayProto[method] = function(...args){\r\n        // 调用原数组方法，切片编程\r\n        const result = oldArrayProto[method].call(this, ...args)\r\n\r\n        // 对新增的数据进行劫持\r\n        let inserted;\r\n        let ob = this.__ob__;\r\n        switch(method){\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = args;\r\n                break;\r\n            case 'splice':\r\n                inserted = args.slice(2);\r\n                break;\r\n            default: \r\n                break;\r\n        }\r\n        // 对新增的数据进行观测\r\n        if(inserted){\r\n            ob.observeArray(inserted)\r\n        }\r\n\r\n        ob.dep.notify()\r\n        \r\n        return result\r\n    }\r\n})","/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-13 15:41:25\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-14 18:00:59\r\n * @FilePath: \\vue2-rollup\\src\\observe\\dep.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\nlet id = 0;\r\nclass Dep {\r\n    constructor(){\r\n        this.id = id++; // 属性的dep要收集watcher\r\n        this.subs = []; // 这里存放着当前属性对应的watcher有哪些\r\n    }\r\n    depend(){\r\n        Dep.target.addDep(this)\r\n    }\r\n    addSub(watcher){\r\n        this.subs.push(watcher)\r\n    }\r\n    notify(){\r\n        this.subs.forEach(watcher=>watcher.update())\r\n    }\r\n}\r\nDep.target = null;\r\n\r\nlet stack = [];\r\nexport function pushTarget(watcher){\r\n    stack.push(watcher)\r\n    Dep.target = watcher\r\n}\r\nexport function popTarget(){\r\n    stack.pop()\r\n    Dep.target = stack[stack.length - 1]\r\n}\r\n\r\nexport default Dep","/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-07 17:11:23\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-14 17:43:41\r\n * @FilePath: \\vue2-rollup\\src\\observe\\index.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\n\r\nimport { isObject } from \"../utils/index\";\r\nimport { newArrayProto } from \"./array\";\r\nimport Dep from \"./dep\";\r\n\r\nclass Observer{\r\n    constructor(data){\r\n        // data可以是数组也可以是对象\r\n        this.dep = new Dep()\r\n\r\n        // 将__ob__变成不可枚举（循环的时候无法获取）\r\n        Object.defineProperty(data, '__ob__', {\r\n            value: this,\r\n            enumerable: false\r\n        })\r\n        // data.__ob__ = this;\r\n        if(Array.isArray(data)){\r\n            // 保留数组原有的特性，并且重写部分方法\r\n            data.__proto__ =  newArrayProto\r\n            this.observeArray(data)\r\n        }else{\r\n            this.walk(data)\r\n        }\r\n    }\r\n    walk(data){\r\n        Object.keys(data).forEach(key=>{\r\n            // 对 data 中的每个属性进行响应式处理\r\n            defineReactive(data, key, data[key])\r\n        })\r\n    }\r\n    observeArray(data){\r\n        data.forEach(item => observe(item))\r\n    }\r\n}\r\n\r\nfunction dependArray(value){\r\n    for(let i=0;i<value.length;i++){\r\n        let current = value[i]\r\n        current.__ob__ && current.__ob__.dep.depend()\r\n        if(Array.isArray(current)){\r\n            dependArray(current)\r\n        }\r\n    }\r\n}\r\nfunction defineReactive(data, key, value){\r\n    // 对深层次对象进行递归处理\r\n    let childOb = observe(value)\r\n\r\n    let dep = new Dep()\r\n    // 重写对象，给每个属性添加get和set\r\n    Object.defineProperty(data, key, {\r\n        get(){\r\n            if(Dep.target){\r\n                dep.depend()\r\n                if(childOb){\r\n                    childOb.dep.depend()\r\n                    if(Array.isArray(value)){\r\n                        dependArray(value)\r\n                    }\r\n                }\r\n            }\r\n            return value\r\n        },\r\n        set(newVal){\r\n            if(newVal === value) return;\r\n            // 对象赋值  重新代理\r\n            observe(newVal)\r\n            value = newVal\r\n            dep.notify()\r\n        }\r\n    })\r\n}\r\n\r\nexport function observe(data){\r\n    // 判断data是否返回一个对象，vue要求data return {}\r\n    if(!isObject(data)) return\r\n    // 说明这个对象已经被代理过了\r\n    if(data.__ob__ instanceof Observer){\r\n        return data.__ob__;\r\n    }\r\n    // 返回一个响应式对象\r\n    return new Observer(data)\r\n}","/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-07 16:46:24\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-07 17:27:13\r\n * @FilePath: \\vue2-rollup\\src\\state.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\nimport { observe } from './observe/index';\r\nimport { isFunction } from './utils/index'\r\nexport function initState(vm){\r\n    const opts = vm.$options;\r\n    // 初始化data\r\n    if(opts.data){\r\n        initData(vm)\r\n    }\r\n}\r\n// 初始化data\r\nfunction initData(vm){\r\n    let data = vm.$options.data;\r\n    // 往实例上添加一个 _data 属性，即传入的data\r\n    // vue组件data推荐使用函数，防止数据在组件之间共享\r\n    data = vm._data = isFunction(data) ? data.call(vm) : data;\r\n    // 将vm._data上的数据代理到vm上\r\n    for(let key in data){\r\n        proxy(vm, \"_data\", key)\r\n    }\r\n    // 对数据进行观测\r\n    observe(data)\r\n}\r\n// 代理数据\r\nfunction proxy(vm, source, key){\r\n    Object.defineProperty(vm, key, {\r\n        get(){\r\n            return vm[source][key]\r\n        },\r\n        set(newVal){\r\n            vm[source][key] = newVal\r\n        }\r\n    })\r\n}\r\n","import Dep, { popTarget, pushTarget } from \"./dep\";\r\n\r\n/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-13 15:27:50\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-14 18:01:50\r\n * @FilePath: \\vue2-rollup\\src\\observe\\watcher.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\nlet id = 0;\r\nclass Watcher{\r\n    constructor(vm, fn, options){\r\n        this.id = id++;\r\n        this.renderWatcher = options;\r\n        this.getter = fn;\r\n        this.deps = [];\r\n        this.depsIds = new Set()\r\n        this.get()\r\n    }\r\n    addDep(dep){\r\n        let id = dep.id;\r\n        if(!this.depsIds.has(id)){\r\n            this.deps.push(dep);\r\n            this.depsIds.add(id)\r\n            dep.addSub(this)\r\n        }\r\n    }\r\n    get(){\r\n        pushTarget(this)\r\n        this.getter()\r\n        popTarget() // 渲染完毕后清空\r\n    }\r\n    update(){\r\n        queueWatcher(this)\r\n    }\r\n    run(){\r\n        this.get()\r\n    }\r\n}\r\n\r\n/**\r\n * @param {Array} queue watcher队列\r\n * @param {*} has watcher 的id集合\r\n */\r\nlet queue = [];\r\nlet has = {};\r\nlet pending = false; // 防抖\r\nfunction flushSchedulerQueue(){\r\n    let flushQueue = queue.slice(0)\r\n    queue = []\r\n    has = {}\r\n    pending = false\r\n    flushQueue.forEach(q=>q.run())\r\n}\r\nfunction queueWatcher(watcher){\r\n    const id = watcher.id;\r\n    if(!has[id]){\r\n        queue.push(watcher)\r\n        has[id] = true\r\n        if(!pending){\r\n            nextTick(flushSchedulerQueue, 0)\r\n            pending = true\r\n        }\r\n    }\r\n}\r\n\r\nlet callback = [];\r\nlet waiting = false;\r\nfunction flushCallbacks(){\r\n    let cbs = callback.slice(0)\r\n    waiting = false;\r\n    callback = []\r\n    cbs.forEach(cb=>cb())\r\n}\r\n// nextTick 没有直接使用某个api 而是采用优雅降级的方式\r\n// 内部先采用Promise（ie不兼容） MutationObserver（h5的api） ie专享的setImmediate  最后是setTimeout\r\n// let timerFunc;\r\n// if(Promise){\r\n//     timerFunc = ()=>{\r\n//         Promise.resolve().then(flushCallbacks)\r\n//     }\r\n// }else if(MutationObserver){\r\n//     let observer = new MutationObserver(flushCallbacks)\r\n//     let textNode = document.createTextNode(1)\r\n//     observer.observe(textNode,{\r\n//         characterData: true\r\n//     })\r\n//     timerFunc = ()=>{\r\n//         textNode.textContent = 2\r\n//     }\r\n// }else if(setImmediate){\r\n//     timerFunc = ()=>{\r\n//         setImmediate(flushCallbacks)\r\n//     }\r\n// }else{\r\n//     timerFunc = ()=>{\r\n//         setTimeout(flushCallbacks)\r\n//     }\r\n// }\r\n// 改进后的不需要兼容ie了 直接使用Promise\r\nexport function nextTick(cb){\r\n    callback.push(cb)\r\n    if(!waiting){\r\n        // timerFunc()\r\n        Promise.resolve().then(flushCallbacks)\r\n        waiting = true\r\n    }\r\n}\r\n\r\nexport default Watcher","/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-13 10:46:16\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-13 14:19:14\r\n * @FilePath: \\vue2-rollup\\src\\vdom\\index.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\n\r\n\r\nexport function createElementVnode(vm, tag, data, ...children){\r\n    if(data === null){\r\n        data = {}\r\n    }\r\n    let key = data.key;\r\n    if(key){\r\n        delete data.key\r\n    }\r\n    return vnode(vm, tag, key, data, children)\r\n}\r\n\r\nexport function createTextVnode(vm, text){\r\n    return vnode(vm, undefined, undefined, undefined, undefined, text)\r\n}\r\n\r\n// 虚拟DOM\r\nfunction vnode(vm, tag, key, data, children, text){\r\n    return {\r\n        vm,\r\n        tag,\r\n        key,\r\n        data,\r\n        children,\r\n        text\r\n    }\r\n}","import Watcher from './observe/watcher';\r\nimport { createElementVnode, createTextVnode } from './vdom'\r\n\r\n/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-09 16:51:07\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-14 15:33:14\r\n * @FilePath: \\vue2-rollup\\src\\lifecycle.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\nfunction createElm(vnode){\r\n    let {tag,data,children,text} = vnode\r\n    if(typeof tag === 'string'){ // 标签\r\n        vnode.el = document.createElement(tag)\r\n        patchProps(vnode.el, data)\r\n        children.forEach(child => {\r\n            vnode.el.appendChild(createElm(child))\r\n        });\r\n    }else{\r\n        vnode.el = document.createTextNode(text)\r\n    }\r\n    return vnode.el\r\n}\r\n\r\nfunction patchProps(el, props){\r\n    for(let key in props){\r\n        if(key === 'style'){\r\n            // style: {color: 'red'; background: 'orange'}\r\n            for(let styleName in props.style){\r\n                el.style[styleName] = props.style[styleName]\r\n            }\r\n        }else{\r\n            el.setAttribute(key, props[key])\r\n        }\r\n    }\r\n}\r\n\r\nfunction patch(oldVNode, vnode){\r\n\r\n    const isRealElement = oldVNode.nodeType;\r\n    // isRealElement为真即为 初始渲染\r\n    if(isRealElement){\r\n        const elm = oldVNode; // 拿到真是元素\r\n        const parentElm = elm.parentNode; // 拿到父元素\r\n        let newElm = createElm(vnode)\r\n        parentElm.insertBefore(newElm, elm.nextSibling)\r\n        parentElm.removeChild(elm) // 删除老节点\r\n        return newElm\r\n    }else{\r\n        // diff算法\r\n    }\r\n}\r\n\r\nexport function initLifeCycle(Vue){\r\n    Vue.prototype._update = function(vnode){\r\n        const vm = this;\r\n        const el = vm.$el;\r\n        // patch既有初始化的功能，又有更新\r\n        vm.$el = patch(el, vnode)\r\n    }\r\n    Vue.prototype._c = function(){\r\n        return createElementVnode(this, ...arguments)\r\n    }\r\n    Vue.prototype._v = function(){\r\n        return createTextVnode(this, ...arguments)\r\n    }\r\n    Vue.prototype._s = function(value){\r\n        if(typeof value !== 'object') return value;\r\n        return JSON.stringify(value)\r\n    }\r\n    Vue.prototype._render = function(){\r\n        const vm = this;\r\n        return vm.$options.render.call(vm)\r\n    }\r\n}\r\n\r\nexport function mountComponent(vm, el){\r\n    vm.$el = el;\r\n    \r\n    // 1、调用render方法产生虚拟节点 虚拟DOM\r\n    const updateComponent = function(){\r\n        vm._update(vm._render())\r\n    }\r\n    let watcher = new Watcher(vm, updateComponent, true)\r\n    // 2、根据虚拟DOM产生真实DOM\r\n\r\n    // 3、插入到el元素中\r\n}\r\n\r\nexport function callHook(vm, hook){\r\n    const handlers = vm.$options[hook];\r\n    if(handlers){\r\n        handlers.forEach(handler=>handler.call(vm))\r\n    }\r\n}","import { compileToFunction } from \"./compiler\";\r\nimport { initState } from \"./state\";\r\nimport { callHook, mountComponent } from \"./lifecycle\"\r\nimport { mergeOptions } from \"./utils\";\r\n\r\n/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-07 16:39:18\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-14 15:42:26\r\n * @FilePath: \\vue2-rollup\\src\\init.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\nexport function initMixin(Vue){\r\n    Vue.prototype._init = function(options){\r\n        const vm = this;\r\n        // 在实例上添加 $options 属性\r\n        vm.$options = mergeOptions(this.constructor.options, options);\r\n        \r\n        callHook(vm, 'beforeCreate')\r\n        // 初始化状态，包括initProps、initData、initMethod、initComputed、initWatch等\r\n        initState(vm)\r\n\r\n        callHook(vm, 'created')\r\n\r\n\r\n        // 挂载数据\r\n        if(options.el){\r\n            vm.$mount(options.el)\r\n        }\r\n    }\r\n    Vue.prototype.$mount = function(el){\r\n        const vm = this;\r\n        const opts = vm.$options;\r\n        el = document.querySelector(el)\r\n        /**\r\n         * 1、把模板转化成render函数\r\n         * 2、执行render函数，生成VNode\r\n         * 3、更新时进行diff\r\n         * 4、产生真实DOM\r\n         */\r\n        // 可以直接在options中写render函数\r\n        // 优先级： render > template > el\r\n        if(!opts.render){\r\n            let template = opts.template\r\n            if(!opts.template && el){\r\n                template = el.outerHTML;\r\n            }\r\n            // 写了 template 就用写了的 template\r\n            if(template){\r\n                // 将 template转化成render函数\r\n                const render = compileToFunction(template)\r\n                opts.render = render;\r\n            }\r\n        }\r\n        // 组件的挂载\r\n        mountComponent(vm, el)\r\n    }\r\n}\r\n\r\n","/*\r\n * @Author: JLDiao\r\n * @Date: 2022-09-07 16:11:59\r\n * @LastEditors: ***\r\n * @LastEditTime: 2022-09-14 15:17:57\r\n * @FilePath: \\vue2-rollup\\src\\index.js\r\n * @Description: \r\n * Copyright (c) 2022 by JLDiao, All Rights Reserved. \r\n */\r\n\r\nimport { initGlobalApi } from \"./globalApi\"\r\nimport { initMixin } from \"./init\"\r\nimport { initLifeCycle } from \"./lifecycle\"\r\nimport { nextTick } from \"./observe/watcher\"\r\n\r\n// 创建一个Vue构造函数\r\nfunction Vue(options){\r\n    this._init(options)\r\n}\r\n\r\nVue.prototype.$nextTick = nextTick\r\n\r\ninitMixin(Vue)\r\ninitLifeCycle(Vue)\r\ninitGlobalApi(Vue)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport default Vue"],"names":["isFunction","val","isObject","strats","LIFECYCLE","forEach","hook","p","c","concat","mergeOptions","parent","child","options","key","mergeField","hasOwnProperty","initGlobalApi","Vue","mixin","defaultTagRE","genProps","attrs","str","i","length","attr","name","obj","value","split","item","JSON","stringify","slice","gen","node","type","codegen","text","test","tokens","match","index","lastIndex","exec","push","trim","join","genChildren","children","map","ast","code","tag","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","attribute","parseHTML","template","ELEMENT_TYPE","TEXT_TYPE","stack","currentParent","root","createASTElement","start","tagName","chars","replace","end","pop","advance","n","substring","parseStartTag","textEnd","indexOf","startTagMatch","endTagMatch","compileToFunction","render","Function","oldArrayProto","Array","prototype","newArrayProto","Object","create","methods","method","args","result","call","inserted","ob","__ob__","observeArray","dep","notify","id","Dep","subs","target","addDep","watcher","update","pushTarget","popTarget","Observer","data","defineProperty","enumerable","isArray","__proto__","walk","keys","defineReactive","observe","dependArray","current","depend","childOb","get","set","newVal","initState","vm","opts","$options","initData","_data","proxy","source","Watcher","fn","renderWatcher","getter","deps","depsIds","Set","has","add","addSub","queueWatcher","queue","pending","flushSchedulerQueue","flushQueue","q","run","nextTick","callback","waiting","flushCallbacks","cbs","cb","Promise","resolve","then","createElementVnode","vnode","createTextVnode","undefined","createElm","el","document","createElement","patchProps","appendChild","createTextNode","props","styleName","style","setAttribute","patch","oldVNode","isRealElement","nodeType","elm","parentElm","parentNode","newElm","insertBefore","nextSibling","removeChild","initLifeCycle","_update","$el","_c","arguments","_v","_s","_render","mountComponent","updateComponent","callHook","handlers","handler","initMixin","_init","constructor","$mount","querySelector","outerHTML","$nextTick"],"mappings":"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"}